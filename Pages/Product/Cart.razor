@page "/cart"
@using SubashaVentures.Components.Shared.Buttons
@using SubashaVentures.Layout.Main
@layout LandingPageLayout

<div class="cart-page">
    <div class="page-header">
        <h1 class="page-title">Shopping Cart</h1>
        <p class="page-subtitle">@cartItems.Count item@(cartItems.Count != 1 ? "s" : "") in your cart</p>
    </div>

    @if (!cartItems.Any())
    {
        <!-- Empty Cart State -->
        <div class="empty-cart">
            <div class="empty-icon">üõí</div>
            <h2 class="empty-title">Your cart is empty</h2>
            <p class="empty-text">Add some items to your cart to get started</p>
            <a href="shop" class="continue-shopping-btn">
                <PrimaryButton Size="PrimaryButton.ButtonSize.Large">
                    Continue Shopping
                </PrimaryButton>
            </a>
        </div>
    }
    else
    {
        <div class="cart-container">
            <!-- Cart Items Section -->
            <div class="cart-items-section">
                @foreach (var item in cartItems)
                {
                    <div class="cart-item">
                        <div class="item-image">
                            <img src="@item.ImageUrl" alt="@item.Name" />
                        </div>

                        <div class="item-details">
                            <h3 class="item-name">@item.Name</h3>
                            <div class="item-variants">
                                @if (!string.IsNullOrEmpty(item.Size))
                                {
                                    <span class="variant">Size: @item.Size</span>
                                }
                                @if (!string.IsNullOrEmpty(item.Color))
                                {
                                    <span class="variant">Color: 
                                        <span class="color-dot" style="background-color: @item.Color"></span>
                                    </span>
                                }
                            </div>
                            <div class="item-stock">
                                @if (item.Stock > 0)
                                {
                                    <span class="in-stock">In Stock</span>
                                }
                                else
                                {
                                    <span class="out-of-stock">Out of Stock</span>
                                }
                            </div>
                        </div>

                        <div class="item-quantity">
                            <button class="qty-btn" 
                                    @onclick="() => DecreaseQuantity(item.Id)" 
                                    disabled="@(item.Quantity <= 1)">
                                -
                            </button>
                            <span class="qty-value">@item.Quantity</span>
                            <button class="qty-btn" 
                                    @onclick="() => IncreaseQuantity(item.Id)" 
                                    disabled="@(item.Quantity >= item.Stock)">
                                +
                            </button>
                        </div>

                        <div class="item-price">
                            <span class="price">‚Ç¶@((item.Price * item.Quantity).ToString("N0"))</span>
                            <span class="unit-price">‚Ç¶@item.Price.ToString("N0") each</span>
                        </div>

                        <button class="remove-btn" 
                                @onclick="() => RemoveItem(item.Id)"
                                title="Remove from cart">
                            ‚úï
                        </button>
                    </div>
                }

                <!-- Continue Shopping Link -->
                <div class="continue-shopping">
                    <a href="shop" class="continue-link">‚Üê Continue Shopping</a>
                </div>
            </div>

            <!-- Order Summary Section -->
            <div class="order-summary">
                <h2 class="summary-title">Order Summary</h2>

                <div class="summary-details">
                    <div class="summary-row">
                        <span class="label">Subtotal</span>
                        <span class="value">‚Ç¶@subtotal.ToString("N0")</span>
                    </div>

                    <div class="summary-row">
                        <span class="label">Shipping</span>
                        <span class="value">
                            @if (shippingCost > 0)
                            {
                                <text>‚Ç¶@shippingCost.ToString("N0")</text>
                            }
                            else
                            {
                                <text>FREE</text>
                            }
                        </span>
                    </div>

                    @if (discount > 0)
                    {
                        <div class="summary-row discount">
                            <span class="label">Discount</span>
                            <span class="value">-‚Ç¶@discount.ToString("N0")</span>
                        </div>
                    }

                    <div class="summary-divider"></div>

                    <div class="summary-row total">
                        <span class="label">Total</span>
                        <span class="value">‚Ç¶@total.ToString("N0")</span>
                    </div>
                </div>

                <!-- Promo Code -->
                <div class="promo-section">
                    <input type="text" 
                           class="promo-input" 
                           placeholder="Enter promo code"
                           @bind="promoCode" />
                    <button class="apply-promo-btn" @onclick="ApplyPromoCode">
                        Apply
                    </button>
                </div>

                <!-- Checkout Button -->
                <PrimaryButton Size="PrimaryButton.ButtonSize.Large" 
                               CssClass="checkout-btn"
                               OnClick="ProceedToCheckout">
                    Proceed to Checkout
                </PrimaryButton>

                <!-- Payment Methods -->
                <div class="payment-methods">
                    <span class="payment-label">We Accept</span>
                    <div class="payment-icons">
                        <span class="payment-icon">üí≥</span>
                        <span class="payment-icon">üè¶</span>
                        <span class="payment-icon">üí∞</span>
                    </div>
                </div>

                <!-- Trust Badges -->
                <div class="trust-badges">
                    <div class="badge">
                        <span class="badge-icon">üîí</span>
                        <span class="badge-text">Secure Payment</span>
                    </div>
                    <div class="badge">
                        <span class="badge-icon">üöö</span>
                        <span class="badge-text">Fast Delivery</span>
                    </div>
                </div>
            </div>
        </div>
    }
</div>

@code {
    // Code will be in .cs file
}
