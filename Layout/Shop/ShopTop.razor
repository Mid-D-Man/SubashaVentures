@using SubashaVentures.Components.Shared.Forms

<nav class="shop-top-nav">
    <div class="nav-container">
        
        @* Logo *@
        <a href="" class="nav-logo">
            <span class="logo-icon">SV</span>
        </a>

        @* Search Bar Binded *@
        <div class="search-container">
            <InputField 
                Type="text"
                Placeholder="Search products..."
                Value="@SearchQuery"
                ValueChanged="HandleSearchInput"
                PrefixIcon="ðŸ”"
                ShowClearButton="true"
                Size="InputField.InputSize.Medium"
                CssClass="shop-search-input" />
        </div>

        @* Right Actions *@
        <div class="nav-actions">
            @* Cart *@
            <a href="user/cart" class="nav-btn">
                <span class="btn-icon">ðŸ›’</span>
                @if (CartItemCount > 0)
                {
                    <span class="cart-badge">@CartItemCount</span>
                }
            </a>

            @* Profile *@
            <a href="user" class="nav-btn">
                <span class="btn-icon">ðŸ‘¤</span>
            </a>
        </div>
    </div>
</nav>

@code {
    [Parameter] public EventCallback<string> OnSearchChanged { get; set; }
    [Parameter] public int CartItemCount { get; set; }
    
    private string SearchQuery { get; set; } = "";

    // FIXED: Properly handle search input
    private async Task HandleSearchInput(string value)
    {
        SearchQuery = value ?? "";
        
        if (OnSearchChanged.HasDelegate)
        {
            await OnSearchChanged.InvokeAsync(SearchQuery);
        }
    }
}
