@inherits LayoutComponentBase
@inject NavigationManager NavigationManager
@inject ShopStateService ShopState

<div class="shop-layout-wrapper">
    @* Top Navigation - Uses ShopStateService *@
    <ShopTop CartItemCount="@CartItemCount" OnSearchChanged="HandleSearchFromNav" />

    @* Main Shop Container *@
    <div class="shop-container">
        
        @* Desktop Filter Sidebar (Left - 30%) *@
        <aside class="shop-sidebar desktop-only">
            <ShopFilterPanel OnFiltersChanged="HandleFiltersFromSidebar" />
        </aside>

        @* Main Shop Content (Right - 70%) *@
        <main class="shop-content">
            @Body
        </main>
    </div>
</div>

@code {
    [Parameter] public int CartItemCount { get; set; } = 0;

    //use the state service to broadcast events
    private async Task HandleSearchFromNav(string query)
    {
        await ShopState.NotifySearchChanged(query);
    }

    private async Task HandleFiltersFromSidebar(FilterState filters)
    {
        await ShopState.NotifyFiltersChanged(filters);
    }
}
