@inherits LayoutComponentBase
@inject NavigationManager NavigationManager

<div class="shop-layout-wrapper">
    @* Top Navigation - FIXED: Wire up search *@
    <ShopTop CartItemCount="@CartItemCount" OnSearchChanged="HandleSearchFromNav" />

    @* Main Shop Container *@
    <div class="shop-container">
        
        @* Desktop Filter Sidebar (Left - 30%) *@
        <aside class="shop-sidebar desktop-only">
            <ShopFilterPanel OnFiltersChanged="HandleFiltersFromSidebar" />
        </aside>

        @* Main Shop Content (Right - 70%) *@
        <main class="shop-content">
            @Body
        </main>
    </div>
</div>

@code {
    [Parameter] public int CartItemCount { get; set; } = 0;

    // FIXED: These methods pass events to child Shop page
    private async Task HandleSearchFromNav(string query)
    {
        // This will be picked up by the Shop page
        if (Body is SubashaVentures.Pages.Shop.Shop shopPage)
        {
            await shopPage.HandleSearchChanged(query);
        }
    }

    private async Task HandleFiltersFromSidebar(FilterState filters)
    {
        // This will be picked up by the Shop page
        if (Body is SubashaVentures.Pages.Shop.Shop shopPage)
        {
            await shopPage.HandleFiltersChanged(filters);
        }
    }
}
