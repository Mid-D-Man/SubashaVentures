@using SubashaVentures.Components.Shared.Forms
@using SubashaVentures.Components.Shared.Buttons
@inject NavigationManager NavigationManager

<div class="shop-navigation">
    <div class="nav-container">
        
        @* Logo - Desktop *@
        <div class="nav-logo desktop-logo">
            <BrandLogo />
        </div>

        @* Logo - Mobile *@
        <div class="nav-logo mobile-logo">
            <BrandLogo />
        </div>

        @* Search Bar *@
        <div class="nav-search">
            <InputField 
                @bind-Value="SearchQuery"
                Placeholder="Search products..."
                PrefixIcon="ðŸ”"
                CssClass="search-input"
                @bind-Value:event="oninput"
                OnBlur="HandleSearch" />
        </div>

        @* Cart Button *@
        <button class="nav-icon-btn cart-btn" @onclick="NavigateToCart" title="Shopping Cart">
            <span class="icon">ðŸ›’</span>
            @if (CartItemCount > 0)
            {
                <span class="cart-badge">@CartItemCount</span>
            }
        </button>

        @* User/Profile Button *@
        <button class="nav-icon-btn user-btn" @onclick="NavigateToProfile" title="User Profile">
            <span class="icon">ðŸ‘¤</span>
        </button>
    </div>
</div>

@code {
    [Parameter] public int CartItemCount { get; set; } = 0;
    [Parameter] public EventCallback<string> OnSearchChange { get; set; }

    private string SearchQuery { get; set; } = "";

    private async Task HandleSearch()
    {
        if (OnSearchChange.HasDelegate)
        {
            await OnSearchChange.InvokeAsync(SearchQuery);
        }
    }

    private void NavigateToCart()
    {
        NavigationManager.NavigateTo("/cart");
    }

    private void NavigateToProfile()
    {
        NavigationManager.NavigateTo("/profile");
    }
}
